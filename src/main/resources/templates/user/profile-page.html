<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head th:replace="partials/head :: head('Profile')">
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
    <nav th:replace="partials/navbar :: navbar"></nav>
    <div sec:authorize="isAuthenticated()" class="navbar-nav">

    <h1>Profile Page</h1>
    <div class="row">
        <div class="card col-3">
            <img class="card-img-top" id="profile-photo" th:src="${user.getProfile_picture_url().toString()}" alt="Card image cap">
            <div class="card-body">
                <h5 class="card-title" th:text="${user.username}"></h5>
                <p class="card-text" th:text="${user.aboutMe}"></p>
            </div>
            <ul class="list-group list-group-flush">
                <li class="list-group-item" th:text="${user.firstName}"></li>
                <li class="list-group-item" th:text="${user.lastName}"></li>
                <li class="list-group-item" th:text="${user.createdDate}"></li>
                <li class="list-group-item" th:text="${user.birthday}"></li>
                <li class="list-group-item" th:text="${user.email}"></li>
                <li class="list-group-item" th:text="${user.job}"></li>
            </ul>
            <div class="card-body">
                <a th:if="${sessionUser.username == user.username}" th:href="@{/edit/{username}(username=${#authentication.principal.username})}" class="card-link">Edit Profile</a>
                <a th:href="@{/{username}/my-photos (username=${#authentication.principal.username})}" class="btn btn-primary p-3">View Photos</a>
            </div>
        </div>


        <div class="card col-3">
            <div class="card-body row p-3" th:each="item : ${friends}">
                <div class="col">
                    <img class="card-img-top" id="friend-profile-picture" th:src="${item.getFriend().profile_picture_url.toString()}" alt="Card image cap">
                    <div class="card-body">
                        <h5 class="card-title"><a th:href="@{/{username}/friend/{friendName} (username=${sessionUser.getUsername()}, friendName=${item.getFriend().getUsername()})}" th:text="${item.getFriend().username}"></a></h5>
                        <div>
                            <p th:text="${item.getFriend().getFirstName()}"></p>
                            <p th:text="${item.getFriend().getLastName()}"></p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="card col-6" id="gallery-thumbnails">
            <div class="card-body">
                <div class="row" th:each="item: ${galleries}">
                    <div class="col-6">
                        <div th:if="${!item.getPictures().isEmpty()}" id="thumbnail-container">
                            <a th:href="@{/{username}/gallery/{id} (username=${user.getUsername()}, id=${item.getId()})}">
                                <img class="card-img-top gallery-thumbnail-image" th:src="${item.getPictures.get(0).getPictureUrl().toString()}" alt="Gallery Thumbnail Image">
                            </a>
                            <p id="caption" th:text="${item.getName()}"></p>
                        </div>
                        <div th:if="${item.getPictures().isEmpty()}">
                            <a th:href="@{/{username}/gallery/{id} (username=${user.getUsername()}, id=${item.getId()})}">
                                <img class="card-img-top gallery-thumbnail-image" src="/img/thumbnailDefault.jpg" alt="Gallery Thumbnail Image">
                            </a>
                            <p class="caption" th:text="${item.getName()}"></p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    </div>





    <footer th:replace="partials/footer :: footer"></footer>
</body>
</html>